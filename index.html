<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image" href="icon.png">
<title>Happy Birthday, Kate!</title>
<style>
        body {
            margin: 0;
            padding: 0;
            background-color: #fef0f7;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }



        .page {
            text-align: center;
            margin-bottom: 50px;
            display: none;
        }

        .page.active {
            display: block;
        }

        .title {
            font-size: 48px;
            font-weight: bold;
            color: #444;
            margin: 0;
            line-height: 1.2;
        }

        .subtitle {
            color: #e889aa;
            font-size: 48px;
            font-weight: bold;
            margin: 0;
            display: inline;
        }

        .emoji {
            font-size: 48px;
            margin-left: 10px;
            color: #444;
        }

        .instruction {
            color: #6d7e96;
            font-size: 18px;
            margin: 30px 0;
            font-weight: 500;
        }

        .next-btn {
            background: #e889aa;
            color: white;
            border: none;
            padding: 15px 60px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(232, 137, 170, 0.3);
        }

        .next-btn:hover {
            background: #d577a0;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(232, 137, 170, 0.4);
        }

        .next-btn:active {
            transform: translateY(0);
        }

        .envelope-img, .crying-img, .header-img {
            max-width: 300px;
            height: auto;
            margin-bottom: 30px;
        }
        
        .crying-img {
            margin-top: 20px;
        }
        
        .header-img {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 15px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 5px solid white;
            transform: rotate(-3deg);
            transition: transform 0.3s ease;
        }
        
        .header-img:hover {
            transform: rotate(3deg);
        }

        .question-text {
            font-size: 24px;
            color: #444;
            margin: 20px 0 40px 0;
            font-weight: 500;
        }
        
        .plea-title {
            font-size: 36px;
            font-weight: bold;
            color: #444;
            margin: 5px 0;
            line-height: 1.2;
        }
        
        .plea-subtitle {
            font-size: 32px;
            font-weight: bold;
            color: #444;
            margin: 5px 0 40px 0;
        }

        .button-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
        }

        .choice-btn {
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .open-btn {
            background: #e889aa;
            color: white;
            box-shadow: 0 4px 15px rgba(232, 137, 170, 0.3);
        }

        .open-btn:hover {
            background: #d577a0;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(232, 137, 170, 0.4);
        }

        .no-btn {
            background: #7dd3c0;
            color: white;
            box-shadow: 0 4px 15px rgba(125, 211, 192, 0.3);
        }

        .no-btn:hover {
            background: #6bc4b0;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(125, 211, 192, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .letter-container {
            background: #fff;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            animation: slideIn 0.3s ease;
        }

        .letter-header {
            background: #ffd6e4;
            padding: 15px 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ffc0d5;
        }

        .letter-title {
            font-size: 20px;
            font-weight: bold;
            color: #7a4b73;
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #7a4b73;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .close-btn:hover {
            background: #ffbcd5;
        }

        .letter-content {
            padding: 30px;
            background-color: #ffebf2; /* 备用背景色 */
            background-image: url('background-letter.png');
            background-size: 100% 100%;
            min-height: 500px;
            position: relative;
        }

        .letter-greeting {
            font-size: 24px;
            font-weight: bold;
            color: #7a4b73;
            margin-bottom: 30px;
            margin-top: 60px;
            font-style: italic;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
        }

        .letter-text {
            font-size: 16px;
            line-height: 1.8;
            color: #7a4b73;
            margin-bottom: 20px;
            text-align: left;
            font-style: italic;
            text-shadow: 0 0 3px rgba(255, 255, 255, 0.7);
            padding: 0 20px;
        }

        .letter-signature {
            text-align: right;
            font-style: italic;
            color: #7a4b73;
            margin-top: 40px;
            padding-right: 20px;
            margin-bottom: 30px;
            text-shadow: 0 0 3px rgba(255, 255, 255, 0.7);
        }
        
        [contenteditable="true"]:focus {
            outline: 2px dashed rgba(255, 150, 180, 0.5);
            padding: 5px;
            border-radius: 5px;
        }
        
        .letter-actions {
            text-align: center;
            margin-bottom: 30px;
        }
        


        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to { 
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 32px;
            }
            
            .subtitle {
                font-size: 32px;
            }
            
            .emoji {
                font-size: 32px;
            }
            
            .header-img {
                width: 150px;
                height: 150px;
                border-radius: 12px;
            }
            
            .instruction {
                font-size: 16px;
                margin: 20px 0;
            }
            
            .next-btn {
                padding: 12px 40px;
                font-size: 16px;
            }
            
            .envelope-img, .crying-img {
                max-width: 250px;
            }
            
            .question-text {
                font-size: 20px;
                margin: 15px 0 30px 0;
            }
            
            .plea-title {
                font-size: 28px;
            }
            
            .plea-subtitle {
                font-size: 24px;
            }
            
            .choice-btn {
                padding: 12px 30px;
                font-size: 16px;
            }
            
            .button-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .letter-container {
                width: 95%;
                max-height: 85vh;
            }
            
            .letter-content {
                padding: 20px;
            }
            
            .letter-greeting {
                font-size: 20px;
                margin-top: 40px;
            }
            
            .letter-text {
                font-size: 14px;
                padding: 0 10px;
            }
            
            .letter-signature {
                padding-right: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .title {
                font-size: 28px;
            }
            
            .subtitle {
                font-size: 28px;
            }
            
            .emoji {
                font-size: 28px;
            }
            
            .header-img {
                width: 120px;
                height: 120px;
                border-radius: 10px;
            }
            
            .instruction {
                font-size: 14px;
            }
            
            .plea-title {
                font-size: 24px;
            }
            
            .plea-subtitle {
                font-size: 20px;
            }
            
            .envelope-img, .crying-img {
                max-width: 200px;
            }
            
            .letter-container {
                width: 98%;
            }
            
            .letter-content {
                padding: 15px;
            }
            
            .letter-greeting {
                font-size: 18px;
            }
            
            .letter-text {
                font-size: 13px;
            }
        }

        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(232, 137, 170, 0.9);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            color: white;
            font-size: 20px;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(232, 137, 170, 0.3);
        }
        
        .music-control:hover {
            background: rgba(213, 119, 160, 0.9);
            transform: scale(1.1);
        }
        
        @media (max-width: 768px) {
            .music-control {
                width: 45px;
                height: 45px;
                font-size: 18px;
                bottom: 15px;
                right: 15px;
            }
        }
    </style>
</head>
<body>

    <audio id="bgMusic" loop>
        <source src="background-music.mp3" type="audio/mpeg">
    </audio>

    <audio id="clickSound">
        <source src="clicksound.wav" type="audio/wav">
    </audio>

    <button class="music-control" id="musicToggle" onclick="toggleMusic()">🎵</button>
    <!-- Page 1: Greetings -->
    <div class="page active" id="page1">
        <img src="silly-silly-guy.gif" alt="Birthday character" class="header-img">
        <h1 class="title">Happy Birthday</h1>
        <h1 class="subtitle">Kate!</h1>
        <span class="emoji">(｡◕‿◕｡)</span>
        
        <p class="instruction">Click the next button!! (つ◕v◕)つ♡</p>
        
        <button class="next-btn" onclick="showPage2()">Next!! ♪～♪</button>
    </div>

    <!-- Page 2: Envelope question -->
    <div class="page" id="page2">
        <img src="envelope.jpg" alt="Pink envelope" class="envelope-img">
        
        <p class="question-text">Do you want to open it? "ヾ(＂•̀_•́＂)ノ＂</p>
        
        <div class="button-container">
            <button class="choice-btn open-btn" onclick="openEnvelope()">Open it</button>
            <button class="choice-btn no-btn" onclick="sayNo()">No ty</button>
        </div>
    </div>

    <div class="modal" id="letterModal">
        <div class="letter-container">
            <div class="letter-header">
                <h3 class="letter-title">Ooo.. A message (ﾉ◕o◕)ﾉ♡ !!</h3>
                <button class="close-btn" onclick="closeLetter()">×</button>
            </div>
            <div class="letter-content">
                <div class="letter-greeting">Happy Birthday, KATEEE (^ᴗ^)</div>
                
                <div class="letter-text">
                    Today is all about celebrating you, the amazing friend who brings so much joy and light into the lives of everyone around you. I am so lucky to have you as my friend, and I am truly proud of the person you are and everything you are becoming.
                </div>
                
                <div class="letter-text">
                    You are strong, kind, and full of determination. Whether it is on the badminton court or in life, you always give your best and inspire the people around you. You make every moment more fun and every memory more meaningful.
                </div>
                
                <div class="letter-text">
                    Now that you are 18, I hope this new chapter of your life is filled with endless opportunities, bigger dreams, and the happiness you truly deserve. Thank you for being you. Thank you for all the laughter, the comfort, and the memories I will never forget.
                </div>
                
                <div class="letter-text">
                    Here is to adulthood, new adventures, and even more dreams coming true. Happy 18th birthday. I cannot wait to see everything you will achieve.
                </div>
                
                <div class="letter-text">
                    Happy Birthday, Kate. I cherish you endlessly. ❤️
                </div>
                
                <div class="letter-signature">
                    Alex ♡
                </div>
                

            </div>
        </div>
    </div>

    <!-- Page 3: Please try again -->
    <div class="page" id="page3">
        <img src="crying.gif" alt="Crying character" class="crying-img">
        
        <h2 class="plea-title">Arayy ko.. Let's try again?</h2>
        <h2 class="plea-subtitle">PLEASEE?</h2>
        
        <div class="button-container">
            <button class="choice-btn open-btn" onclick="tryAgain()">Again..?</button>
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', function() {
            const imagesToPreload = [
                'background-letter.png',
                'cyring.gif',
                'silly-silly-guy.gif', 
                'envelope.jpg',
                'd4enwza2ob.jpg'
            ];

            const audioToPreload = [
                'background-music.mp3',
                'clicksound.wav'
            ];
            
            imagesToPreload.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        });
        
        function showPage2() {
            document.getElementById('page1').classList.remove('active');
            document.getElementById('page2').classList.add('active');
        }

        function openEnvelope() {
            document.getElementById('letterModal').classList.add('active');
        }

        function closeLetter() {
            document.getElementById('letterModal').classList.remove('active');
        }

        function sayNo() {
            document.getElementById('page2').classList.remove('active');
            document.getElementById('page3').classList.add('active');
        }
        
        function finalNo() {
            alert('Okay, I understand... maybe next time! 🥺');
            document.getElementById('page3').classList.remove('active');
            document.getElementById('page1').classList.add('active');
        }

        let isMusicPlaying = false;
        
        function toggleMusic() {
            const music = document.getElementById('bgMusic');
            const musicBtn = document.getElementById('musicToggle');
            
            playClickSound();
            
            if (isMusicPlaying) {
                music.pause();
                musicBtn.innerHTML = '🎵';
                isMusicPlaying = false;
            } else {
                music.play().catch(e => {
                    console.log('Music autoplay is blocked, please tap the screen and try again');
                });
                musicBtn.innerHTML = '🔇';
                isMusicPlaying = true;
            }
        }

        function playClickSound() {
            const clickSound = document.getElementById('clickSound');
            clickSound.currentTime = 0;
            clickSound.play().catch(e => {
                console.log('Click sound effect failed to play');
            });
        }

        document.addEventListener('click', function() {
            if (!isMusicPlaying) {

                const music = document.getElementById('bgMusic');
                music.play().catch(e => {

                });
                document.getElementById('musicToggle').innerHTML = '🔇';
                isMusicPlaying = true;
            }
        }, { once: true });

        document.addEventListener('DOMContentLoaded', function() {

            const buttons = document.querySelectorAll('button, .choice-btn, .next-btn, .save-btn, .music-control');

            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    playClickSound();
                });
            });

            const editableElements = document.querySelectorAll('[contenteditable="true"]');
            editableElements.forEach(element => {

                element.addEventListener('click', function() {
                    playClickSound();
                });

                element.addEventListener('input', function() {
                    saveLetterContent(false);
                });

                element.addEventListener('blur', function() {
                    saveLetterContent(false);
                });
            });
        });
        
        function tryAgain() {
            document.getElementById('page3').classList.remove('active');
            document.getElementById('page1').classList.add('active');
        }
        
        function saveLetterContent(showAlert = true) {
            if (showAlert) {
                alert('Content saved! 💌');
            }

            const letterGreeting = document.querySelector('.letter-greeting').innerText;
            const letterTexts = [...document.querySelectorAll('.letter-text')].map(el => el.innerText);
            const letterSignature = document.querySelector('.letter-signature').innerHTML;

            localStorage.setItem('letterContent', JSON.stringify({
                greeting: letterGreeting,
                texts: letterTexts,
                signature: letterSignature
            }));
        }
        
        function loadSavedContent() {
            const savedContent = localStorage.getItem('letterContent');
            
            if (savedContent) {
                try {
                    const content = JSON.parse(savedContent);

                    document.querySelector('.letter-greeting').innerText = content.greeting;
                    
                    const textElements = document.querySelectorAll('.letter-text');
                    content.texts.forEach((text, index) => {
                        if (textElements[index]) {
                            textElements[index].innerText = text;
                        }
                    });
                    
                    document.querySelector('.letter-signature').innerHTML = content.signature;
                } catch (e) {
                    console.error('Failed to load saved content', e);
                }
            }
        }

        window.addEventListener('DOMContentLoaded', loadSavedContent);

        window.onclick = function(event) {
            const modal = document.getElementById('letterModal');
            if (event.target === modal) {
                closeLetter();
            }
        }
    </script>
</body>
</html>